# Парсер вакансий с HeadHunter

## Описание проекта

Данный проект представляет собой инструмент для сбора данных о компаниях и их вакансиях с сайта hh.ru через API, сохранения этих данных в базу данных PostgreSQL и последующей работы с ними.

## Функциональность

- Получение данных о работодателях и их вакансиях через API hh.ru
- Автоматическое создание базы данных и таблиц в PostgreSQL
- Сохранение полученных данных в БД
- Выполнение различных запросов к БД через класс DBManager

**Примечание о работе с базой данных:**

В процессе разработки была выявлена специфическая проблема, связанная с ошибкой кодировки (`UnicodeDecodeError`) при попытке установления соединения с базой данных PostgreSQL с использованием библиотеки `psycopg2` в конкретном рабочем окружении (операционная система Windows).

Несмотря на то, что код для автоматического создания базы данных и таблиц, а также код для загрузки данных и выполнения запросов через `DBManager` был полностью реализован в соответствии с требованиями проекта, эта ошибка блокировала выполнение данных операций.

Поскольку проблема связана с низкоуровневым взаимодействием библиотеки с окружением и не могла быть решена в рамках проекта без перенастройки операционной системы или сервера БД, для демонстрации функциональности работы с данными база данных и таблицы были **созданы вручную**.

Весь реализованный код для автоматического создания БД, загрузки данных и выполнения запросов включен в проект и демонстрирует логику работы с базой данных, даже если его выполнение сейчас блокируется внешней ошибкой.

## Структура проекта

- `main.py` - основной скрипт для запуска программы
- `api_HH.py` - модуль для взаимодействия с API hh.ru
- `db.py` - модуль для работы с базой данных
- `.env` - файл с переменными окружения (не включен в репозиторий)
- `requirements.txt` - файл с зависимостями проекта

## Требования

Для работы программы необходимы следующие компоненты:

- Python 3.8+
- PostgreSQL
- Библиотеки Python (см. requirements.txt)

## Установка и настройка

1. Клонировать репозиторий
2. Установить зависимости: `pip install -r requirements.txt`
3. Создать файл `.env` в корне проекта со следующими переменными:
    ```
    DB_NAME=название_базы_данных
    DB_USER=имя_пользователя
    DB_PASSWORD=пароль
    DB_HOST=хост (обычно localhost)
    DB_PORT=порт (обычно 5432)
    ```
4. **Вручную создать** базу данных с именем, указанным в `.env`, и выполнить SQL-скрипты для создания таблиц `employers` и `vacancies` (SQL-скрипты можно найти в коде функции `create_database` в файле `db.py` или использовать те, что были предоставлены в ходе разработки).
5. Запустить программу: `python main.py`

## Класс DBManager

Класс для работы с данными в БД имеет следующие методы:

- `get_companies_and_vacancies_count()` - получает список всех компаний и количество вакансий у каждой компании
- `get_all_vacancies()` - получает список всех вакансий с указанием названия компании, названия вакансии, зарплаты и ссылки на вакансию
- `get_avg_salary()` - получает среднюю зарплату по вакансиям
- `get_vacancies_with_higher_salary()` - получает список всех вакансий, у которых зарплата выше средней по всем вакансиям
- `get_vacancies_with_keyword()` - получает список всех вакансий, в названии которых содержатся переданные в метод слова

## Автор

Проект разработан в рамках учебного задания.
